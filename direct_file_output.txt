This was written with direct FILE* operations
